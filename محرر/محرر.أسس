
اشمل "مـتم/ريـاضيات.أسس"؛
اشمل "مـتم/نـم.أسس"؛ 
اشمل "رسوم.أسس"؛

هيئ_عصا_التحكم()؛
عرف النقوش: مصفوفة[مؤشر[طـوب.نـقش]، 7]؛
النقوش(1) = طـوب.صـورة.حمل_نقش(رسام، "صور/مربع_بني.png")؛
النقوش(2) = طـوب.صـورة.حمل_نقش(رسام، "صور/مؤشر.png")؛
النقوش(3) = طـوب.صـورة.حمل_نقش(رسام، "صور/مثلث_بني.png")؛
النقوش(4) = طـوب.صـورة.حمل_نقش(رسام، "صور/مثلث_أخضر.png")؛
النقوش(5) = طـوب.صـورة.حمل_نقش(رسام، "صور/مثلث_أخضر2.png")؛
النقوش(6) = طـوب.صـورة.حمل_نقش(رسام، "صور/مثلث_أخضر3.png")؛
عرف نقش_السماء: مؤشر[طـوب.نـقش] = طـوب.صـورة.حمل_نقش(رسام، "صور/سماء.png")؛
عرف س: صحيح = 0؛
عرف ص: صحيح = 0؛
عرف بداية: صحيح = 0؛
عرف تحريك_الخلفية: صحيح = 0؛
عرف تحريك_الخلفية2: صحيح = 1280؛
عرف نهاية: صحيح = 1280؛
عرف خارطة : مصفوفة [مصفوفة[صحيح، 15]، 50]؛
عرف سع : صحيح؛ 
عرف صع : صحيح؛
عرف ن : صحيح؛
عرف عداد_النقوش : صحيح=0؛ 
عرف حدد_نقش : صحيح=1؛
  
  دالة ارسم_خارطة(){
    عرف س :صحيح؛
    عرف ص :صحيح؛
    لكل س=0، س < 50، س+=1{
      لكل ص=0، ص < 15، ص+=1{
        إذا خارطة(س)(ص) > 0 {  
          ن = خارطة(س)(ص)؛
          اطمغ(النقوش(ن)، س*50-بداية، ص*50)؛
        }؛
      }؛
    }؛
  }؛
  
  دالة خزن {
    عرف ملف:مؤشر[مـتم.نـم.مـلف] = مـتم.نـم.افتح_ملف ("خارطة" ، "w")؛
    لكل س=0، س < 50، س+=1{
      لكل ص=0، ص < 15، ص+=1{  
        مـتم.نـم.اكتب (خارطة(س)(ص)~مؤشر، خارطة(س)(ص)~حجم، 1، ملف)؛        
      }؛
    }؛ 
    مـتم.نـم.اغلق_ملف (ملف)؛
  }؛
  
  دالة حمل {
    عرف ملف:مؤشر[مـتم.نـم.مـلف] = مـتم.نـم.افتح_ملف ("خارطة" ، "r")؛
    لكل س=0، س < 50، س+=1{
      لكل ص=0، ص < 15، ص+=1{
        مـتم.نـم.اقرأ (خارطة(س)(ص)~مؤشر، خارطة(س)(ص)~حجم، 1، ملف)؛        
      }؛
    }؛ 
    مـتم.نـم.اغلق_ملف (ملف)؛
  }؛
  حمل()؛
  بينما 1 {
  سع = طـوب.عـصا_التحكم.هات_محور(عصا0، 0)؛
  صع = طـوب.عـصا_التحكم.هات_محور(عصا0، 1)؛
  إذا سع>=10000 {س += 5}؛
  إذا سع<=-10000 {س -= 5}؛
  إذا صع>=10000 {ص += 5}؛
  إذا صع<=-10000 {ص -= 5}؛
  
  إذا س <= بداية {س = بداية}؛
  إذا س >= نهاية {س = نهاية}؛
  إذا ص <= 0 {ص = 0}؛
  إذا ص >= 700{ص = 700}؛
  اطمغ(نقش_السماء، 0، 0)؛
  اطمغ(نقش_السماء، تحريك_الخلفية، 0)؛
  اطمغ(نقش_السماء، تحريك_الخلفية2، 0)؛
  إذا حدد_نقش < 1 {حدد_نقش = 6}؛
  إذا حدد_نقش > 6 {حدد_نقش = 1}؛
  اطمغ(النقوش(حدد_نقش)، س-بداية، ص)؛
  إذا طـوب.عـصا_التحكم.هات_زر(عصا0، 0) == 1 {
    خارطة(س÷50)(ص÷50) = حدد_نقش؛
  }؛
  إذا طـوب.عـصا_التحكم.هات_زر(عصا0، 1) == 1 {
    خارطة(س÷50)(ص÷50) = 0؛ 
  }؛
  إذا طـوب.عـصا_التحكم.هات_زر(عصا0، 4) == 1 {
    إذا عداد_النقوش <= 31 {
      عداد_النقوش+=1؛
    }؛
    إذا عداد_النقوش >= 30 {
      حدد_نقش-=1؛
      عداد_النقوش = 0؛
    }؛
  }؛
  إذا طـوب.عـصا_التحكم.هات_زر(عصا0، 5) == 1 {
    إذا عداد_النقوش <= 30 {
      عداد_النقوش+=1؛
    }؛
    إذا عداد_النقوش >= 30 {
      حدد_نقش+=1؛
      عداد_النقوش = 0؛
    }؛
    }؛
    إذا بداية >= 0 {
    إذا طـوب.عـصا_التحكم.هات_زر(عصا0، 6) == 1 {
    نهاية -= 5؛
    بداية -= 5؛
    تحريك_الخلفية+=1؛
    تحريك_الخلفية2+=1؛
    إذا تحريك_الخلفية == -1280{
      تحريك_الخلفية = 1280؛
    }؛
    إذا تحريك_الخلفية2 == -1280{
    تحريك_الخلفية2 = 1280؛
    }؛
    }؛
    }؛
  إذا نهاية <= 2509 {  
  إذا طـوب.عـصا_التحكم.هات_زر(عصا0، 7) == 1 {
    نهاية += 5؛
    بداية += 5؛
    تحريك_الخلفية-=1؛
    تحريك_الخلفية2-=1؛
    إذا تحريك_الخلفية == -1280{
      تحريك_الخلفية = 1280؛
    }؛
    إذا تحريك_الخلفية2 == -1280{
    تحريك_الخلفية2 = 1280؛
    }؛
    }؛
    }؛
     إذا طـوب.عـصا_التحكم.هات_زر(عصا0، 10) == 1 {
     خزن()؛
    اخرج(1)؛
  }؛

  ارسم_خارطة()؛  
  طـوب.رسـام.اعرض(رسام)؛
  افحص_الخروج()؛
  مـتم.نـظام.نم(15000)
  }؛
